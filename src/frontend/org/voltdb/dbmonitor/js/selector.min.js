/*! jQuery Selectorator - v0.1.5 - 2016-07-06
 * https://github.com/ngs/jquery-selectorator
 * Copyright (c) 2016 Atsushi Nagase; Licensed MIT */
(function () {
  !(function (a) {
    var b, c, d, e, f, g, h, i;
    return (
      (h = a.map),
      (f = a.extend),
      (g = a.inArray),
      (d = function (a, b) {
        return g(a, b) !== -1;
      }),
      (e = function (a) {
        return a.replace(
          /([\!\"\#\$\%\&'\(\)\*\+\,\.\/\:\;<\=>\?\@\[\\\]\^\`\{\|\}\~])/g,
          "\\$1"
        );
      }),
      (c = function (a, b) {
        return h(a, function (a) {
          return a === b ? null : a;
        });
      }),
      (i = function (a) {
        return h(a, function (b, c) {
          return parseInt(c, 10) === parseInt(a.indexOf(b), 10) ? b : null;
        });
      }),
      (b = (function () {
        function b(b, c) {
          (this.element = b),
            (this.options = f(f({}, a.selectorator.options), c)),
            (this.cachedResults = {});
        }
        return (
          (b.prototype.query = function (b) {
            var c;
            return (
              (c = this.cachedResults)[b] ||
              (c[b] = a(b.replace(/#([^\s]+)/g, "[id='$1']")))
            );
          }),
          (b.prototype.getProperTagName = function () {
            return this.element[0]
              ? this.element[0].tagName.toLowerCase()
              : null;
          }),
          (b.prototype.hasParent = function () {
            return this.element && 0 < this.element.parent().length;
          }),
          (b.prototype.isElement = function () {
            var a;
            return (a = this.element[0]), a && a.nodeType === a.ELEMENT_NODE;
          }),
          (b.prototype.validate = function (a, b, c, e) {
            var f, g;
            if (
              (null == c && (c = !0),
              null == e && (e = !1),
              (g = this.query(a)),
              (c && 1 < g.length) || (!c && 0 === g.length))
            ) {
              if (!b || a.indexOf(":") !== -1) return null;
              if (
                ((f = e ? " > " : " "),
                (a = b + f + a),
                (g = this.query(a)),
                (c && 1 < g.length) || (!c && 0 === g.length))
              )
                return null;
            }
            return d(this.element[0], g.get()) ? a : null;
          }),
          (b.prototype.generate = function () {
            var a, b, d, e, f;
            if (!(this.element && this.hasParent() && this.isElement()))
              return [""];
            for (
              f = [],
                e = [
                  this.generateSimple,
                  this.generateAncestor,
                  this.generateRecursive,
                ],
                b = 0,
                d = e.length;
              b < d;
              b++
            )
              if (((a = e[b]), (f = i(c(a.call(this)))), f && f.length > 0))
                return f;
            return i(f);
          }),
          (b.prototype.generateAncestor = function () {
            var c, d, e, f, g, h, i, j, k, l, m, n, o, p;
            for (
              n = [], m = this.element.parents(), c = 0, g = m.length;
              c < g;
              c++
            ) {
              for (
                j = m[c],
                  d = !0,
                  p = this.generateSimple(null, !1),
                  e = 0,
                  h = p.length;
                e < h;
                e++
              )
                for (
                  o = p[e],
                    l = new b(a(j), this.options).generateSimple(null, !1),
                    f = 0,
                    i = l.length;
                  f < i;
                  f++
                )
                  (k = l[f]), a.merge(n, this.generateSimple(k, !0, d));
              d = !1;
            }
            return n;
          }),
          (b.prototype.generateSimple = function (a, b, d) {
            var e, f, g, i, j, k, l, m;
            for (
              k = this,
                l = k.getProperTagName(),
                m = function (c) {
                  return k.validate(c, a, b, d);
                },
                i = [
                  [k.getIdSelector],
                  [k.getClassSelector],
                  [k.getIdSelector, !0],
                  [k.getClassSelector, !0],
                  [k.getNameSelector],
                  [
                    function () {
                      return [k.getProperTagName()];
                    },
                  ],
                ],
                f = 0,
                g = i.length;
              f < g;
              f++
            )
              if (
                ((e = i[f]),
                (j = e[0].call(k, e[1]) || []),
                (j = c(h(j, m))),
                j.length > 0)
              )
                return j;
            return [];
          }),
          (b.prototype.generateRecursive = function () {
            var a, c, d, e;
            return (
              (e = this.getProperTagName()),
              e.indexOf(":") !== -1 && (e = "*"),
              (c = this.element.parent()),
              (d = new b(c).generate()[0]),
              (a = c.children(e).index(this.element)),
              (e = e + ":eq(" + a + ")"),
              "" !== d && (e = d + " > " + e),
              [e]
            );
          }),
          (b.prototype.getIdSelector = function (a) {
            var b;
            return (
              null == a && (a = !1),
              (a = a ? this.getProperTagName() : ""),
              (b = this.element.attr("id")),
              "string" != typeof b || d(b, this.getIgnore("id")) || "" === b
                ? null
                : [a + "#" + e(b)]
            );
          }),
          (b.prototype.getClassSelector = function (a) {
            var b, c, f;
            return (
              null == a && (a = !1),
              (f = this.getProperTagName()),
              /^(body|html)$/.test(f)
                ? null
                : ((a = a ? f : ""),
                  (c = this.getIgnore("class")),
                  (b = (this.element.attr("class") || "")
                    .replace(/\{.*\}/, "")
                    .split(/\s/)),
                  h(b, function (b) {
                    return b && !d(b, c) ? a + "." + e(b) : null;
                  }))
            );
          }),
          (b.prototype.getNameSelector = function () {
            var a, b;
            return (
              (b = this.getProperTagName()),
              (a = this.element.attr("name")),
              a && !d(a, this.getIgnore("name"))
                ? [b + "[name='" + a + "']"]
                : null
            );
          }),
          (b.prototype.getIgnore = function (a) {
            var b, c, d;
            return (
              (c = this.options.ignore || {}),
              (b = "class" === a ? "classes" : a + "s"),
              (d = c[a] || c[b]),
              "string" == typeof d ? [d] : d
            );
          }),
          b
        );
      })()),
      (a.selectorator = {
        options: {},
        unique: i,
        clean: c,
        escapeSelector: e,
      }),
      (a.fn.selectorator = function (c) {
        return new b(a(this), c);
      }),
      (a.fn.getSelector = function (a) {
        return this.selectorator(a).generate();
      }),
      this
    );
  })(jQuery);
}.call(this));
