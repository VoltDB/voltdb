DROP PROCEDURE InitTable 		IF EXISTS;
DROP PROCEDURE UDAFSum 			IF EXISTS;
DROP PROCEDURE UDAFCount 		IF EXISTS;
DROP PROCEDURE ClearTable 		IF EXISTS;
DROP AGGREGATE FUNCTION myavg 		IF EXISTS;
DROP AGGREGATE FUNCTION mysum 		IF EXISTS;
DROP AGGREGATE FUNCTION mycnt 		IF EXISTS;
DROP AGGREGATE FUNCTION mysumfloat 	IF EXISTS;
DROP AGGREGATE FUNCTION myavgacc 	IF EXISTS;

DROP TABLE t IF EXISTS;

CREATE TABLE t (
	a INTEGER NOT NULL,
	b INTEGER,
	c FLOAT,
	d VARCHAR(20) NOT NULL,
);

PARTITION TABLE t ON COLUMN d;

LOAD CLASSES myudafs.jar;
LOAD CLASSES udaf-procs.jar;

CREATE AGGREGATE FUNCTION myavg 	 FROM CLASS Uaverage;
CREATE AGGREGATE FUNCTION myavgacc 	 FROM CLASS UaverageAcc;
CREATE AGGREGATE FUNCTION mysum 	 FROM CLASS Usum;
CREATE AGGREGATE FUNCTION mycnt 	 FROM CLASS Ucount;
CREATE AGGREGATE FUNCTION mysumfloat FROM CLASS UsumFloat;

CREATE PROCEDURE FROM CLASS udaf.InitTable;
CREATE PROCEDURE FROM CLASS udaf.UDAFSum;
CREATE PROCEDURE FROM CLASS udaf.UDAFCount;
CREATE PROCEDURE ClearTable AS
	DELETE FROM t;


