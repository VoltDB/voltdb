SELECT a.contestant_name AS contestant_name, a.contestant_number AS contestant_number, SUM(b.num_votes) AS total_votes FROM v_votes_by_contestant_number_state AS b, contestants AS a WHERE a.contestant_number = b.contestant_number GROUP BY a.contestant_name, a.contestant_number ORDER BY total_votes DESC, contestant_number ASC, contestant_name ASC;
{"PLAN_NODES":[{"ID":1,"PLAN_NODE_TYPE":"SEND","CHILDREN_IDS":[2]},{"ID":2,"PLAN_NODE_TYPE":"ORDERBY","CHILDREN_IDS":[3],"SORT_COLUMNS":[{"SORT_EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2},"SORT_DIRECTION":"DESC"},{"SORT_EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1},"SORT_DIRECTION":"ASC"},{"SORT_EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":50,"COLUMN_IDX":0},"SORT_DIRECTION":"ASC"}]},{"ID":3,"PLAN_NODE_TYPE":"HASHAGGREGATE","CHILDREN_IDS":[4],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":50,"COLUMN_IDX":0}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":2,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":50,"COLUMN_IDX":0},{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}]},{"ID":4,"PLAN_NODE_TYPE":"RECEIVE","CHILDREN_IDS":[5],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":50,"COLUMN_IDX":0}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2}}]},{"ID":5,"PLAN_NODE_TYPE":"SEND","CHILDREN_IDS":[6]},{"ID":6,"PLAN_NODE_TYPE":"NESTLOOPINDEX","INLINE_NODES":[{"ID":7,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":8,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":50,"COLUMN_IDX":1}}]}],"TARGET_TABLE_NAME":"CONTESTANTS","TARGET_TABLE_ALIAS":"A","LOOKUP_TYPE":"EQ","SORT_DIRECTION":"INVALID","TARGET_INDEX_NAME":"VOLTDB_AUTOGEN_CONSTRAINT_IDX_PK_CONTESTANTS","SEARCHKEY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}],"COMPARE_NOTDISTINCT":[false],"END_EXPRESSION":{"TYPE":10,"VALUE_TYPE":23,"LEFT":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0,"TABLE_IDX":1},"RIGHT":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}}},{"ID":9,"PLAN_NODE_TYPE":"HASHAGGREGATE","OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":50,"COLUMN_IDX":3}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":2}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":2,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":50,"COLUMN_IDX":3},{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":2}]}],"CHILDREN_IDS":[10],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":50,"COLUMN_IDX":3}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":2}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2}}],"JOIN_TYPE":"INNER","PRE_JOIN_PREDICATE":null,"JOIN_PREDICATE":null,"WHERE_PREDICATE":null,"OUTPUT_SCHEMA_PRE_AGG":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"NUM_VOTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0,"TABLE_IDX":1}},{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":50,"COLUMN_IDX":1,"TABLE_IDX":1}}]},{"ID":10,"PLAN_NODE_TYPE":"SEQSCAN","INLINE_NODES":[{"ID":11,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"NUM_VOTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2}}]}],"TARGET_TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","TARGET_TABLE_ALIAS":"B"}]}