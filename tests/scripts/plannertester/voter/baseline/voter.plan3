SELECT a.contestant_name AS contestant_name, a.contestant_number AS contestant_number, SUM(b.num_votes) AS total_votes FROM v_votes_by_contestant_number_state AS b, contestants AS a WHERE a.contestant_number = b.contestant_number GROUP BY a.contestant_name, a.contestant_number ORDER BY total_votes DESC, contestant_number ASC, contestant_name ASC;
{"PLAN_NODES":[{"ID":1,"PLAN_NODE_TYPE":"SEND","INLINE_NODES":[],"CHILDREN_IDS":[2],"PARENT_IDS":[]},{"ID":2,"PLAN_NODE_TYPE":"PROJECTION","INLINE_NODES":[],"CHILDREN_IDS":[3],"PARENT_IDS":[1],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":0,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NAME"}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NUMBER"}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"COLUMN_IDX":2,"TABLE_NAME":"VOLT_TEMP_TABLE","COLUMN_NAME":""}}]},{"ID":3,"PLAN_NODE_TYPE":"ORDERBY","INLINE_NODES":[],"CHILDREN_IDS":[4],"PARENT_IDS":[2],"SORT_COLUMNS":[{"SORT_EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"COLUMN_IDX":2,"TABLE_NAME":"VOLT_TEMP_TABLE","COLUMN_NAME":""},"SORT_DIRECTION":"DESC"},{"SORT_EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NUMBER"},"SORT_DIRECTION":"ASC"},{"SORT_EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":0,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NAME"},"SORT_DIRECTION":"ASC"}]},{"ID":4,"PLAN_NODE_TYPE":"HASHAGGREGATE","INLINE_NODES":[],"CHILDREN_IDS":[5],"PARENT_IDS":[3],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":3,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NAME"}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":2,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NUMBER"}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"COLUMN_IDX":2,"TABLE_NAME":"VOLT_TEMP_TABLE","COLUMN_NAME":""}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":2,"AGGREGATE_EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1,"TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","COLUMN_NAME":"NUM_VOTES"}}],"GROUPBY_EXPRESSIONS":[{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":3,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NAME"},{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":2,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NUMBER"}]},{"ID":5,"PLAN_NODE_TYPE":"NESTLOOPINDEX","INLINE_NODES":[{"ID":0,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":38,"PLAN_NODE_TYPE":"PROJECTION","INLINE_NODES":[],"CHILDREN_IDS":[],"PARENT_IDS":[],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NUMBER"}},{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":1,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NAME"}}]}],"CHILDREN_IDS":[],"PARENT_IDS":[],"PREDICATE":null,"TARGET_TABLE_NAME":"CONTESTANTS","KEY_ITERATE":false,"LOOKUP_TYPE":"EQ","SORT_DIRECTION":"INVALID","TARGET_INDEX_NAME":"SYS_IDX_PK_CONTESTANTS_10019","END_EXPRESSION":{"TYPE":"COMPARE_EQUAL","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"LEFT":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NUMBER"},"RIGHT":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","COLUMN_NAME":"CONTESTANT_NUMBER"}},"SEARCHKEY_EXPRESSIONS":[{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","COLUMN_NAME":"CONTESTANT_NUMBER"}]}],"CHILDREN_IDS":[6],"PARENT_IDS":[4],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","COLUMN_NAME":"CONTESTANT_NUMBER"}},{"COLUMN_NAME":"NUM_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1,"TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","COLUMN_NAME":"NUM_VOTES"}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NUMBER"}},{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":1,"TABLE_NAME":"CONTESTANTS","COLUMN_NAME":"CONTESTANT_NAME"}}],"JOIN_TYPE":"INNER","PRE_JOIN_PREDICATE":null,"JOIN_PREDICATE":null,"WHERE_PREDICATE":null},{"ID":6,"PLAN_NODE_TYPE":"RECEIVE","INLINE_NODES":[],"CHILDREN_IDS":[7],"PARENT_IDS":[5],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","COLUMN_NAME":"CONTESTANT_NUMBER"}},{"COLUMN_NAME":"NUM_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1,"TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","COLUMN_NAME":"NUM_VOTES"}}]},{"ID":7,"PLAN_NODE_TYPE":"SEND","INLINE_NODES":[],"CHILDREN_IDS":[8],"PARENT_IDS":[6]},{"ID":8,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":0,"PLAN_NODE_TYPE":"PROJECTION","INLINE_NODES":[],"CHILDREN_IDS":[],"PARENT_IDS":[],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","COLUMN_NAME":"CONTESTANT_NUMBER"}},{"COLUMN_NAME":"NUM_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":2,"TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","COLUMN_NAME":"NUM_VOTES"}}]}],"CHILDREN_IDS":[],"PARENT_IDS":[7],"PREDICATE":null,"TARGET_TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","KEY_ITERATE":true,"LOOKUP_TYPE":"GTE","SORT_DIRECTION":"ASC","DETERMINISM_ONLY":true,"TARGET_INDEX_NAME":"MATVIEW_PK_INDEX","END_EXPRESSION":null,"SEARCHKEY_EXPRESSIONS":[]}],"PARAMETERS":[]}