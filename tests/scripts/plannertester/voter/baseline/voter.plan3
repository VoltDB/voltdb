SELECT a.contestant_name AS contestant_name, a.contestant_number AS contestant_number, SUM(b.num_votes) AS total_votes FROM v_votes_by_contestant_number_state AS b, contestants AS a WHERE a.contestant_number = b.contestant_number GROUP BY a.contestant_name, a.contestant_number ORDER BY total_votes DESC, contestant_number ASC, contestant_name ASC;
{"PLAN_NODES":[{"ID":1,"PLAN_NODE_TYPE":"SEND","INLINE_NODES":[],"CHILDREN_IDS":[2]},{"ID":2,"PLAN_NODE_TYPE":"PROJECTION","INLINE_NODES":[],"CHILDREN_IDS":[3],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":0}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"COLUMN_IDX":2}}]},{"ID":3,"PLAN_NODE_TYPE":"ORDERBY","INLINE_NODES":[],"CHILDREN_IDS":[4],"SORT_COLUMNS":[{"SORT_EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"COLUMN_IDX":2},"SORT_DIRECTION":"DESC"},{"SORT_EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1},"SORT_DIRECTION":"ASC"},{"SORT_EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":0},"SORT_DIRECTION":"ASC"}]},{"ID":4,"PLAN_NODE_TYPE":"HASHAGGREGATE","INLINE_NODES":[],"CHILDREN_IDS":[5],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":0}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"COLUMN_IDX":2}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":2,"AGGREGATE_EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"COLUMN_IDX":2}}],"GROUPBY_EXPRESSIONS":[{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":0},{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1}]},{"ID":5,"PLAN_NODE_TYPE":"RECEIVE","INLINE_NODES":[],"CHILDREN_IDS":[6],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":0}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"COLUMN_IDX":2}}]},{"ID":6,"PLAN_NODE_TYPE":"SEND","INLINE_NODES":[],"CHILDREN_IDS":[7]},{"ID":7,"PLAN_NODE_TYPE":"HASHAGGREGATE","INLINE_NODES":[],"CHILDREN_IDS":[8],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":3}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":2}},{"COLUMN_NAME":"TOTAL_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"COLUMN_IDX":2}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":2,"AGGREGATE_EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1}}],"GROUPBY_EXPRESSIONS":[{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":3},{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":2}]},{"ID":8,"PLAN_NODE_TYPE":"NESTLOOPINDEX","INLINE_NODES":[{"ID":0,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":40,"PLAN_NODE_TYPE":"PROJECTION","INLINE_NODES":[],"CHILDREN_IDS":[],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0}},{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":1}}]}],"CHILDREN_IDS":[],"TARGET_TABLE_NAME":"CONTESTANTS","TARGET_TABLE_ALIAS":"A","LOOKUP_TYPE":"EQ","SORT_DIRECTION":"INVALID","TARGET_INDEX_NAME":"SYS_IDX_PK_CONTESTANTS_10019","SEARCHKEY_EXPRESSIONS":[{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0}],"END_EXPRESSION":{"TYPE":"COMPARE_EQUAL","VALUE_TYPE":"BIGINT","VALUE_SIZE":8,"LEFT":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_IDX":1},"RIGHT":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0}}}],"CHILDREN_IDS":[9],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0}},{"COLUMN_NAME":"NUM_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":1}},{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0,"TABLE_IDX":1}},{"COLUMN_NAME":"CONTESTANT_NAME","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"STRING","VALUE_SIZE":50,"COLUMN_IDX":1,"TABLE_IDX":1}}],"JOIN_TYPE":"INNER","PRE_JOIN_PREDICATE":null,"JOIN_PREDICATE":null,"WHERE_PREDICATE":null},{"ID":9,"PLAN_NODE_TYPE":"SEQSCAN","INLINE_NODES":[{"ID":0,"PLAN_NODE_TYPE":"PROJECTION","INLINE_NODES":[],"CHILDREN_IDS":[],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"CONTESTANT_NUMBER","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":0}},{"COLUMN_NAME":"NUM_VOTES","EXPRESSION":{"TYPE":"VALUE_TUPLE","VALUE_TYPE":"INTEGER","VALUE_SIZE":4,"COLUMN_IDX":2}}]}],"CHILDREN_IDS":[],"TARGET_TABLE_NAME":"V_VOTES_BY_CONTESTANT_NUMBER_STATE","TARGET_TABLE_ALIAS":"B"}],"PARAMETERS":[]}