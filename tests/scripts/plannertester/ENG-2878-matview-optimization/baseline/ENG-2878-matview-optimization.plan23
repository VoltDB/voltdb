(select a1, sum(a) from t1 as foo where b >= 2 or b1 in (3, 300, 30) group by a1) intersect (select a1, sum(a) from t11 group by a1) union all (select a1, sum(a) from t11 group by a1) except (select a1, sum(a) from t1 as foo where b >= 2 or b1 in (3, 300, 30) group by a1) intersect ((select a1, sum(a) from t11 group by a1) union all (select a1, sum(a) from t11 group by a1));
{"PLAN_NODES":[{"ID":1,"PLAN_NODE_TYPE":"SEND","CHILDREN_IDS":[2]},{"ID":2,"PLAN_NODE_TYPE":"UNION","CHILDREN_IDS":[3,13],"UNION_TYPE":"EXCEPT"},{"ID":3,"PLAN_NODE_TYPE":"UNION","CHILDREN_IDS":[4,10],"UNION_TYPE":"UNION_ALL"},{"ID":4,"PLAN_NODE_TYPE":"UNION","CHILDREN_IDS":[5,7],"UNION_TYPE":"INTERSECT"},{"ID":5,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":6,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2}}]}],"TARGET_TABLE_NAME":"V5_1","TARGET_TABLE_ALIAS":"V5_1","LOOKUP_TYPE":"GTE","SORT_DIRECTION":"ASC","PURPOSE":3,"TARGET_INDEX_NAME":"MATVIEW_PK_INDEX"},{"ID":7,"PLAN_NODE_TYPE":"SEQSCAN","INLINE_NODES":[{"ID":8,"PLAN_NODE_TYPE":"HASHAGGREGATE","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":1,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}]},{"ID":9,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}}]}],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}}],"TARGET_TABLE_NAME":"T11","TARGET_TABLE_ALIAS":"T11"},{"ID":10,"PLAN_NODE_TYPE":"SEQSCAN","INLINE_NODES":[{"ID":11,"PLAN_NODE_TYPE":"HASHAGGREGATE","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":1,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}]},{"ID":12,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}}]}],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}}],"TARGET_TABLE_NAME":"T11","TARGET_TABLE_ALIAS":"T11"},{"ID":13,"PLAN_NODE_TYPE":"UNION","CHILDREN_IDS":[14,16],"UNION_TYPE":"INTERSECT"},{"ID":14,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":15,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2}}]}],"TARGET_TABLE_NAME":"V5_1","TARGET_TABLE_ALIAS":"V5_1","LOOKUP_TYPE":"GTE","SORT_DIRECTION":"ASC","PURPOSE":3,"TARGET_INDEX_NAME":"MATVIEW_PK_INDEX"},{"ID":16,"PLAN_NODE_TYPE":"UNION","CHILDREN_IDS":[17,20],"UNION_TYPE":"UNION_ALL"},{"ID":17,"PLAN_NODE_TYPE":"SEQSCAN","INLINE_NODES":[{"ID":18,"PLAN_NODE_TYPE":"HASHAGGREGATE","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":1,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}]},{"ID":19,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}}]}],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}}],"TARGET_TABLE_NAME":"T11","TARGET_TABLE_ALIAS":"T11"},{"ID":20,"PLAN_NODE_TYPE":"SEQSCAN","INLINE_NODES":[{"ID":21,"PLAN_NODE_TYPE":"HASHAGGREGATE","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":1,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}]},{"ID":22,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"A","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}}]}],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"A1","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"C2","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":1}}],"TARGET_TABLE_NAME":"T11","TARGET_TABLE_ALIAS":"T11"}]}