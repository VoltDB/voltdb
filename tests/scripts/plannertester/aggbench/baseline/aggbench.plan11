select hour( from_unixtime(TB1.timestamp_id / 1000  ) ) time_hour, minute( from_unixtime( TB1.timestamp_id / 1000 ) ) time_minute, TB2.corporate corporate, sum(TB1.bytes) volume from TB1, TB2 where TB1.TB2_id = TB2.TB2_id AND TB2.corporate = '44' group by corporate, hour( from_unixtime(TB1.timestamp_id / 1000  ) ), minute( from_unixtime( TB1.timestamp_id / 1000 ) );
{"PLAN_NODES":[{"ID":1,"PLAN_NODE_TYPE":"SEND","CHILDREN_IDS":[2]},{"ID":2,"PLAN_NODE_TYPE":"HASHAGGREGATE","CHILDREN_IDS":[3],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIME_HOUR","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"TIME_MINUTE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"CORPORATE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":255,"COLUMN_IDX":2}},{"COLUMN_NAME":"VOLUME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":3}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":3,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":3}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":255,"COLUMN_IDX":2},{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0},{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}]},{"ID":3,"PLAN_NODE_TYPE":"RECEIVE","CHILDREN_IDS":[4],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIME_HOUR","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"TIME_MINUTE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"CORPORATE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":255,"COLUMN_IDX":2}},{"COLUMN_NAME":"VOLUME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":3}}]},{"ID":4,"PLAN_NODE_TYPE":"SEND","CHILDREN_IDS":[5]},{"ID":5,"PLAN_NODE_TYPE":"NESTLOOPINDEX","INLINE_NODES":[{"ID":0,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":54,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIMESTAMP_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}},{"COLUMN_NAME":"TB2_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":14}},{"COLUMN_NAME":"BYTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":20}}]}],"TARGET_TABLE_NAME":"TB1","TARGET_TABLE_ALIAS":"TB1","LOOKUP_TYPE":"GTE","SORT_DIRECTION":"INVALID","TARGET_INDEX_NAME":"USER_INFO_TB2_ID_TIMESTAMP_ID_IDX","SEARCHKEY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}],"END_EXPRESSION":{"TYPE":10,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":14,"TABLE_IDX":1},"RIGHT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}},"SKIP_NULL_PREDICATE":{"TYPE":9,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":14,"TABLE_IDX":1}}},{"ID":0,"PLAN_NODE_TYPE":"HASHAGGREGATE","OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIME_HOUR","EXPRESSION":{"TYPE":100,"VALUE_TYPE":5,"ARGS":[{"TYPE":100,"VALUE_TYPE":11,"ARGS":[{"TYPE":4,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2},"RIGHT":{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":1000}}],"NAME":"from_unixtime","ALIAS":"from_unixtime","FUNCTION_ID":20023,"PARAMETER_ARG":-1}],"NAME":"extract","ALIAS":"hour","FUNCTION_ID":1126,"PARAMETER_ARG":-1}},{"COLUMN_NAME":"TIME_MINUTE","EXPRESSION":{"TYPE":100,"VALUE_TYPE":5,"ARGS":[{"TYPE":100,"VALUE_TYPE":11,"ARGS":[{"TYPE":4,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2},"RIGHT":{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":1000}}],"NAME":"from_unixtime","ALIAS":"from_unixtime","FUNCTION_ID":20023,"PARAMETER_ARG":-1}],"NAME":"extract","ALIAS":"minute","FUNCTION_ID":1167,"PARAMETER_ARG":-1}},{"COLUMN_NAME":"CORPORATE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":255,"COLUMN_IDX":1}},{"COLUMN_NAME":"VOLUME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":3}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":3,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":4}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":255,"COLUMN_IDX":1},{"TYPE":100,"VALUE_TYPE":5,"ARGS":[{"TYPE":100,"VALUE_TYPE":11,"ARGS":[{"TYPE":4,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2},"RIGHT":{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":1000}}],"NAME":"from_unixtime","ALIAS":"from_unixtime","FUNCTION_ID":20023,"PARAMETER_ARG":-1}],"NAME":"extract","ALIAS":"hour","FUNCTION_ID":1126,"PARAMETER_ARG":-1},{"TYPE":100,"VALUE_TYPE":5,"ARGS":[{"TYPE":100,"VALUE_TYPE":11,"ARGS":[{"TYPE":4,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2},"RIGHT":{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":1000}}],"NAME":"from_unixtime","ALIAS":"from_unixtime","FUNCTION_ID":20023,"PARAMETER_ARG":-1}],"NAME":"extract","ALIAS":"minute","FUNCTION_ID":1167,"PARAMETER_ARG":-1}]}],"CHILDREN_IDS":[6],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIME_HOUR","EXPRESSION":{"TYPE":100,"VALUE_TYPE":5,"ARGS":[{"TYPE":100,"VALUE_TYPE":11,"ARGS":[{"TYPE":4,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2},"RIGHT":{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":1000}}],"NAME":"from_unixtime","ALIAS":"from_unixtime","FUNCTION_ID":20023,"PARAMETER_ARG":-1}],"NAME":"extract","ALIAS":"hour","FUNCTION_ID":1126,"PARAMETER_ARG":-1}},{"COLUMN_NAME":"TIME_MINUTE","EXPRESSION":{"TYPE":100,"VALUE_TYPE":5,"ARGS":[{"TYPE":100,"VALUE_TYPE":11,"ARGS":[{"TYPE":4,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":2},"RIGHT":{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":1000}}],"NAME":"from_unixtime","ALIAS":"from_unixtime","FUNCTION_ID":20023,"PARAMETER_ARG":-1}],"NAME":"extract","ALIAS":"minute","FUNCTION_ID":1167,"PARAMETER_ARG":-1}},{"COLUMN_NAME":"CORPORATE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":255,"COLUMN_IDX":1}},{"COLUMN_NAME":"VOLUME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":3}}],"JOIN_TYPE":"INNER","PRE_JOIN_PREDICATE":null,"JOIN_PREDICATE":null,"WHERE_PREDICATE":null,"OUTPUT_SCHEMA_PRE_AGG":[{"COLUMN_NAME":"TB2_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}},{"COLUMN_NAME":"CORPORATE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":255,"COLUMN_IDX":1}},{"COLUMN_NAME":"TIMESTAMP_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0,"TABLE_IDX":1}},{"COLUMN_NAME":"TB2_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":14,"TABLE_IDX":1}},{"COLUMN_NAME":"BYTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":20,"TABLE_IDX":1}}]},{"ID":6,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":0,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"TB2_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}},{"COLUMN_NAME":"CORPORATE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":255,"COLUMN_IDX":6}}]}],"TARGET_TABLE_NAME":"TB2","TARGET_TABLE_ALIAS":"TB2","LOOKUP_TYPE":"EQ","SORT_DIRECTION":"INVALID","TARGET_INDEX_NAME":"TB2_CORPORATE_IDX","SEARCHKEY_EXPRESSIONS":[{"TYPE":30,"VALUE_TYPE":9,"VALUE_SIZE":1048576,"ISNULL":false,"VALUE":"44"}],"END_EXPRESSION":{"TYPE":10,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":9,"VALUE_SIZE":255,"COLUMN_IDX":6},"RIGHT":{"TYPE":30,"VALUE_TYPE":9,"VALUE_SIZE":1048576,"ISNULL":false,"VALUE":"44"}}}]}