select TB2.BILLING_TYPE BILLING_TYPE, sum(BYTES) VOLUME from TB1, TB2 where TB1.TB2_id = TB2.TB2_id AND TB2.BILLING_TYPE >= 90 group by (TB2.BILLING_TYPE);
{"PLAN_NODES":[{"ID":1,"PLAN_NODE_TYPE":"SEND","CHILDREN_IDS":[2]},{"ID":2,"PLAN_NODE_TYPE":"HASHAGGREGATE","CHILDREN_IDS":[3],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"BILLING_TYPE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"VOLUME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":1}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":1,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":1}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}]},{"ID":3,"PLAN_NODE_TYPE":"RECEIVE","CHILDREN_IDS":[4],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"BILLING_TYPE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}},{"COLUMN_NAME":"VOLUME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":1}}]},{"ID":4,"PLAN_NODE_TYPE":"SEND","CHILDREN_IDS":[5]},{"ID":5,"PLAN_NODE_TYPE":"NESTLOOPINDEX","INLINE_NODES":[{"ID":0,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":54,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"TB2_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":14}},{"COLUMN_NAME":"BYTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":20}}]}],"TARGET_TABLE_NAME":"TB1","TARGET_TABLE_ALIAS":"TB1","LOOKUP_TYPE":"GTE","SORT_DIRECTION":"INVALID","TARGET_INDEX_NAME":"USER_INFO_TB2_ID_TIMESTAMP_ID_IDX","SEARCHKEY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}],"END_EXPRESSION":{"TYPE":10,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":14,"TABLE_IDX":1},"RIGHT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}},"SKIP_NULL_PREDICATE":{"TYPE":9,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":14,"TABLE_IDX":1}}},{"ID":0,"PLAN_NODE_TYPE":"HASHAGGREGATE","OUTPUT_SCHEMA":[{"COLUMN_NAME":"BILLING_TYPE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"VOLUME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":1}}],"AGGREGATE_COLUMNS":[{"AGGREGATE_TYPE":"AGGREGATE_SUM","AGGREGATE_DISTINCT":0,"AGGREGATE_OUTPUT_COLUMN":1,"AGGREGATE_EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":3}}],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}]}],"CHILDREN_IDS":[6],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"BILLING_TYPE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"VOLUME","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":1}}],"JOIN_TYPE":"INNER","PRE_JOIN_PREDICATE":null,"JOIN_PREDICATE":null,"WHERE_PREDICATE":null,"OUTPUT_SCHEMA_PRE_AGG":[{"COLUMN_NAME":"TB2_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}},{"COLUMN_NAME":"BILLING_TYPE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":1}},{"COLUMN_NAME":"TB2_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":14,"TABLE_IDX":1}},{"COLUMN_NAME":"BYTES","EXPRESSION":{"TYPE":32,"VALUE_TYPE":8,"COLUMN_IDX":20,"TABLE_IDX":1}}]},{"ID":6,"PLAN_NODE_TYPE":"INDEXSCAN","INLINE_NODES":[{"ID":0,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"TB2_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}},{"COLUMN_NAME":"BILLING_TYPE","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":7}}]}],"TARGET_TABLE_NAME":"TB2","TARGET_TABLE_ALIAS":"TB2","LOOKUP_TYPE":"GTE","SORT_DIRECTION":"INVALID","TARGET_INDEX_NAME":"TB2_BILLING_TYPE_IDX","SEARCHKEY_EXPRESSIONS":[{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":90}],"SKIP_NULL_PREDICATE":{"TYPE":9,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":7}}}]}