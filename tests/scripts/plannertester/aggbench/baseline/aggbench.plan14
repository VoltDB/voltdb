select hour( from_unixtime( TB1.timestamp_id / 1000 ) ) time_hour from TB1 GROUP BY hour( from_unixtime( TB1.timestamp_id / 1000 ));
{"PLAN_NODES":[{"ID":1,"PLAN_NODE_TYPE":"SEND","CHILDREN_IDS":[2]},{"ID":2,"PLAN_NODE_TYPE":"HASHAGGREGATE","CHILDREN_IDS":[3],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIME_HOUR","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}}],"AGGREGATE_COLUMNS":[],"GROUPBY_EXPRESSIONS":[{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}]},{"ID":3,"PLAN_NODE_TYPE":"RECEIVE","CHILDREN_IDS":[4],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIME_HOUR","EXPRESSION":{"TYPE":32,"VALUE_TYPE":5,"COLUMN_IDX":0}}]},{"ID":4,"PLAN_NODE_TYPE":"SEND","CHILDREN_IDS":[5]},{"ID":5,"PLAN_NODE_TYPE":"SEQSCAN","INLINE_NODES":[{"ID":0,"PLAN_NODE_TYPE":"HASHAGGREGATE","OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIME_HOUR","EXPRESSION":{"TYPE":100,"VALUE_TYPE":5,"ARGS":[{"TYPE":100,"VALUE_TYPE":11,"ARGS":[{"TYPE":4,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0},"RIGHT":{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":1000}}],"NAME":"from_unixtime","ALIAS":"from_unixtime","FUNCTION_ID":20023,"PARAMETER_ARG":-1}],"NAME":"extract","ALIAS":"hour","FUNCTION_ID":1126,"PARAMETER_ARG":-1}}],"AGGREGATE_COLUMNS":[],"GROUPBY_EXPRESSIONS":[{"TYPE":100,"VALUE_TYPE":5,"ARGS":[{"TYPE":100,"VALUE_TYPE":11,"ARGS":[{"TYPE":4,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0},"RIGHT":{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":1000}}],"NAME":"from_unixtime","ALIAS":"from_unixtime","FUNCTION_ID":20023,"PARAMETER_ARG":-1}],"NAME":"extract","ALIAS":"hour","FUNCTION_ID":1126,"PARAMETER_ARG":-1}]},{"ID":0,"PLAN_NODE_TYPE":"PROJECTION","OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIMESTAMP_ID","EXPRESSION":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0}}]}],"OUTPUT_SCHEMA":[{"COLUMN_NAME":"TIME_HOUR","EXPRESSION":{"TYPE":100,"VALUE_TYPE":5,"ARGS":[{"TYPE":100,"VALUE_TYPE":11,"ARGS":[{"TYPE":4,"VALUE_TYPE":6,"LEFT":{"TYPE":32,"VALUE_TYPE":6,"COLUMN_IDX":0},"RIGHT":{"TYPE":30,"VALUE_TYPE":5,"ISNULL":false,"VALUE":1000}}],"NAME":"from_unixtime","ALIAS":"from_unixtime","FUNCTION_ID":20023,"PARAMETER_ARG":-1}],"NAME":"extract","ALIAS":"hour","FUNCTION_ID":1126,"PARAMETER_ARG":-1}}],"TARGET_TABLE_NAME":"TB1","TARGET_TABLE_ALIAS":"TB1"}]}